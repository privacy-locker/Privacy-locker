<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Secure Data - Privacy Locker</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <!-- HEADER -->
  <header>
    <nav class="navbar">
      <div class="logo">üîê Privacy Locker</div>
      <ul class="nav-links" id="navLinks">
        <li><a href="index.html">Home</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="securedata.html">Secure Data</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </nav>
  </header>

  <!-- MAIN SECTION -->
  <main class="secure-data">
    <h1>Secure Data Locker</h1>

    <!-- Upload New File -->
    <section class="upload-section">
      <h2>Upload New File</h2>
      <form id="uploadForm">
        <input type="file" id="fileInput" required />
        <button type="submit">Upload</button>
      </form>
    </section>

    <!-- Previously Stored Files -->
    <section class="files-section">
      <h2>Previously Stored Files</h2>
      <ul id="storedFilesList">
        <!-- Files will be listed here dynamically -->
      </ul>
    </section>
  </main>

  <!-- FOOTER -->
  <footer>
    <p>¬© 2025 Privacy Locker | All Rights Reserved</p>
  </footer>

  <script>
    // Navbar login/logout
    function updateNavbar() {
      const navLinks = document.getElementById("navLinks");
      const isLoggedIn = localStorage.getItem("isLoggedIn") === "true";

      const existingAuthLink = document.querySelector("#authLink");
      if (existingAuthLink) existingAuthLink.remove();

      const li = document.createElement("li");
      li.id = "authLink";
      if (isLoggedIn) {
        li.innerHTML = '<a href="#" onclick="logout()">Logout</a>';
      } else {
        li.innerHTML = '<a href="index.html">Login</a>';
      }
      navLinks.appendChild(li);
    }

    function logout() {
      localStorage.removeItem("isLoggedIn");
      alert("You have been logged out!");
      window.location.href = "index.html";
    }
    updateNavbar();

    // --- Secure Data JS ---
    const storedFiles = []; // Placeholder, backend will provide this

    const storedFilesList = document.getElementById('storedFilesList');
    const uploadForm = document.getElementById('uploadForm');
    const fileInput = document.getElementById('fileInput');

    // Function to render stored files
    function renderStoredFiles() {
      storedFilesList.innerHTML = '';
      if (storedFiles.length === 0) {
        storedFilesList.innerHTML = '<li>No files stored yet.</li>';
      } else {
        storedFiles.forEach(file => {
          const li = document.createElement('li');
          li.innerHTML = `
            ${file.name} 
            <button onclick="downloadFile('${file.name}')">Download</button>
          `;
          storedFilesList.appendChild(li);
        });
      }
    }

    // Function to simulate file download (backend will handle real files)
    function downloadFile(fileName) {
      alert(`Downloading file: ${fileName}`);
      // In real backend, you will call /download endpoint
    }

    // Handle file upload
    uploadForm.addEventListener('submit', e => {
      e.preventDefault();
      const file = fileInput.files[0];
      if (!file) {
        alert('Please select a file.');
        return;
      }

      // For now, simulate storing file (backend will do real storing)
      storedFiles.push({ name: file.name });
      renderStoredFiles();

      alert(`File "${file.name}" stored successfully!`);
      uploadForm.reset();
    });

    // Initial render
    renderStoredFiles();
  </script>
</body>
</html>
